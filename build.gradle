plugins {
    id 'java'
    id 'idea'
    id 'com.github.johnrengelman.shadow' version '4.0.4'
}

group 'com.rexeb.spark-group-flatten-example'
version '1.0-SNAPSHOT'

sourceCompatibility = 11

repositories {
    mavenCentral()
}

configurations {
    provided
}

sourceSets {
    main {
        compileClasspath += configurations.provided
        runtimeClasspath += configurations.provided
    }
}

dependencies {
    provided group: 'org.apache.spark', name: 'spark-core_2.12', version: '2.4.4'
    testCompile group: 'junit', name: 'junit', version: '4.12'
}

shadowJar {
    archiveClassifier.set('shadow')
    archiveClassifier.convention('shadow')
}

idea {
    module {
        scopes.PROVIDED.plus += [configurations.provided]
    }
}

task run(type: JavaExec, dependsOn: classes) {
    main = mainClass
    classpath sourceSets.main.runtimeClasspath
}
